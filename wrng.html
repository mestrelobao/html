<!DOCTYPE html>
<html>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<body>
  <h1>Digite o c√≥digo ICAO de sua localidade.</h1>
  <form>
  <input type="text" id="formulario" value="">
  <input type="button" value="Enviar" onclick="myfunction()">
</form>
<p id="linha1"></p>
<script>
async function myfunction() {
//mensagens que podemos consultar: metar aviso_aerodromo ciclone cinzas sigwx taf winten
let data = new Date();
let ano_num = data.getFullYear();
let ano = ano_num.toString();  
let mes_num = (data.getMonth()+1);
let mes = mes_num.toString();  
let dia_num = data.getDate();
let dia = dia_num.toString();
let hora = data.getHours()+3;
let icao = document.getElementById("formulario").value;  
  console.log("ano = " + ano);
  console.log("mes = " + mes);
  console.log("dia = " + dia);
  console.log("hora = "+(data.getHours()+3));
  
  let myObject = await fetch("https://api-redemet.decea.mil.br/mensagens/aviso/"+icao+"?api_key=QzbHLKzGoex8tBCb67vCBSk6KdWCPUhjFatzXQ5u&data_ini=2024060510&data_fim=2024060516");
  //let myObject = await fetch("https://redemet.decea.gov.br//api/consulta_automatica/index.php?local="+icao+"&msg=aviso_aerodromo&data_ini="+ano+mes+dia+hora+"&data_fim="+ano+mes+dia+hora);
  let myText = await myObject.text();
  document.getElementById("linha1").innerHTML = myText;
  console.log(myText.message);
  setTimeout(myfunction, 60 * 1000);
}
</script>
</body>
</html>
